<mvc:View controllerName="com.gsitm.pkg.co.zgspkgco0060.controller.Main" displayBlock="true"
    xmlns:table="sap.ui.table"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:l="sap.ui.layout"
    xmlns:f="sap.f"
    xmlns:fb="sap.ui.comp.filterbar"
    xmlns:svm="sap.ui.comp.smartvariants">
    <f:DynamicPage headerExpanded="{/headerExpanded}">
        <f:header>
            <f:DynamicPageHeader>
                <f:content>
                    <fb:FilterBar id="FB_MainSearch" useToolbar="false" search=".onSearch" showFilterConfiguration="false">
                        <fb:filterGroupItems>
                            <fb:FilterGroupItem name="CompanyCode" label="{i18n>CompanyCode}" groupName="MainSearch" mandatory="true" visibleInFilterBar="true">
                                <fb:control>
                                    <Input id="IP_CompanyCode" value="{Search>/CompanyCode}" required="true" />
                                </fb:control>
                            </fb:FilterGroupItem>
                            <!-- 시작 기간 -->
                            <fb:FilterGroupItem name="PriorStartMonth" label="{i18n>PriorStartMonth}" groupName="MainSearch" visibleInFilterBar="true" mandatory="true">
                                <fb:control>
                                    <MultiInput id="MI_PriorStartMonth" width="8rem" showValueHelp="false" />
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem name="PriorEndMonth" label="{i18n>PriorEndMonth}" groupName="MainSearch" visibleInFilterBar="true" mandatory="true">
                                <fb:control>
                                    <MultiInput id="MI_PriorEndMonth" width="8rem" showValueHelp="false"/>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem name="PriorFiscalYear" label="{i18n>PriorFiscalYear}" groupName="MainSearch" visibleInFilterBar="true" mandatory="true">
                                <fb:control>
                                    <MultiInput id="MI_PriorYear" width="10rem" showValueHelp="false"/>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <!-- 비교 기간 -->
                            <fb:FilterGroupItem name="CurrentStartMonth" label="{i18n>CurrentStartMonth}" groupName="MainSearch" visibleInFilterBar="true" mandatory="true">
                                <fb:control>
                                    <MultiInput id="MI_CurrentStartMonth" width="8rem" showValueHelp="false"/>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem name="CurrentEndMonth" label="{i18n>CurrentEndMonth}" groupName="MainSearch" visibleInFilterBar="true" mandatory="true">
                                <fb:control>
                                    <MultiInput id="MI_CurrentEndMonth" width="8rem" showValueHelp="false"/>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem name="CurrentFiscalYear" label="{i18n>CurrentFiscalYear}" groupName="MainSearch" visibleInFilterBar="true" mandatory="true">
                                <fb:control>
                                    <MultiInput id="MI_CurrentYear" width="10rem" showValueHelp="false"/>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem groupName="FB_GROUP" name="GLAccount" label="{i18n>GLAccount}" labelTooltip="{i18n>GLAccount}" visibleInFilterBar="true">
                                <fb:control>
                                    <MultiInput id="MI_GL" width="60%" liveChange=".onLiveChange" valueHelpRequest=".onVHGL" suggestionRows="{
                                            path: 'oGLAccount>/'
                                        }">
                                        <suggestionRows>
                                            <ColumnListItem>
                                                <Label text="{oGLAccount>GLAccount}" />
                                                <Label text="{oGLAccount>GLAccountName}" />
                                            </ColumnListItem>
                                        </suggestionRows>
                                    </MultiInput>
                                </fb:control>
                            </fb:FilterGroupItem>
                        </fb:filterGroupItems>
                    </fb:FilterBar>
                </f:content>
            </f:DynamicPageHeader>
        </f:header>
        <f:content>
            <table:TreeTable id="T_Main" selectionMode="Single" busyIndicatorDelay="0" enableColumnReordering="false" enableCustomFilter="true" enableBusyIndicator="true" rootLevel="1" visibleRowCountMode="Auto">
                <table:extension>
                    <Bar>
                        <contentRight>
                            <SearchField id="SF_TableSearch" width="15rem" search="onTableSearch"/>
                            <!-- 엔터/돋보기 클릭도 동일 동작 -->
                            <Button icon="sap-icon://expand-group" press="onExpandAllPress"/>
                            <Button icon="sap-icon://collapse-group" press="onCollapseAllPress"/>
                            <Button id="B_Excel" busyIndicatorDelay="0" icon="sap-icon://excel-attachment" press="onExport" />
                        </contentRight>
                    </Bar>
                </table:extension>
                <table:columns>
                    <!-- 내역 -->
                    <table:Column hAlign="Center">
                        <Label design="Bold" text="{i18n>NodeText}" />
                        <table:template>
                            <Text textAlign="Begin" text="{NodeText}" />
                        </table:template>
                    </table:Column>

                    <!-- G/L 계정 -->
                    <table:Column hAlign="Left">
                        <Label design="Bold" text="{i18n>GlAccount}" />
                        <table:template>
                            <Text textAlign="Left" text="{GlAccount} {GlAccountText}" />
                        </table:template>
                    </table:Column>

                    <!-- 기간 잔액 -->
                    <table:Column hAlign="End">
                        <Label design="Bold" text="{i18n>PeriodBalance}" />
                        <table:template>
                            <HBox justifyContent="End" width="100%">
                                <Link text="{
                    parts: ['PeriodBalance', 'CompanyCodeCurrency'],

                    type: 'sap.ui.model.type.Currency',
                    formatter: '.formatter.hideZeroCurrency',
                    formatOptions: { showMeasure: false }
                }" press=".onPeriodBalancePress" visible="{= !!${GlAccount}}" />
                                <Text text="{
                    parts: ['PeriodBalance', 'CompanyCodeCurrency'],

                    type: 'sap.ui.model.type.Currency',
                    formatter: '.formatter.hideZeroCurrency',
                    formatOptions: { showMeasure: false }
                }" visible="{= !${GlAccount}}" />
                            </HBox>
                        </table:template>
                    </table:Column>
                    <!-- 비교 기간 잔액 -->
                    <table:Column hAlign="End">
                        <Label design="Bold" text="{i18n>ComparisonBalance}" />
                        <table:template>
                            <Text textAlign="End" text="{
                   parts: ['ComparisonBalance', 'CompanyCodeCurrency'],
                    type: 'sap.ui.model.type.Currency',
                    formatter: '.formatter.hideZeroCurrency',
                    formatOptions: {showMeasure: false }
                }" />
                        </table:template>
                    </table:Column>

                    <!-- 절대 차이 -->
                    <table:Column hAlign="End">
                        <Label design="Bold" text="{i18n>AbsoluteDifference}" />
                        <table:template>
                            <Text textAlign="End" text="{
                       
  parts: [
    { path: 'AbsoluteDifference' },
    { path: 'NodeText' }
  ],
  formatter: '.formatter.hideAbsDiffIfBsPl'


                }" />
                        </table:template>
                    </table:Column>

                    <!-- 상대 차이 -->
                    <table:Column hAlign="End">
                        <Label design="Bold" text="{i18n>RelativeDifference}" />
                        <table:template>
                            <Text textAlign="End" text="{
            path: 'RelativeDifference',
            formatter: '.formatter.hideZeroNumber4'
        }" />
                        </table:template>
                    </table:Column>
                    <!-- 단위 -->
                    <table:Column hAlign="Left" width="10%">
                        <Label design="Bold" text="{i18n>CompanyCodeCurrency}" />
                        <table:template>
                            <Text textAlign="Left" text="{CompanyCodeCurrency}" />
                        </table:template>
                    </table:Column>
                </table:columns>
            </table:TreeTable>
        </f:content>
    </f:DynamicPage>
</mvc:View>
